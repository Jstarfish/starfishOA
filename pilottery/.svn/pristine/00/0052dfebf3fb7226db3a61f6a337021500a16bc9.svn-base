create or replace trigger trig_in_af_cncp_dealers
  after insert
    on cncp_inf_dealers
  for each row
declare
begin
  -- 增加账户信息
  insert into cncp_acc_dealer
    (dealer_code, acc_type, acc_name, acc_status, acc_no, credit_limit, account_balance, frozen_balance, check_code)
  values
    (:new.dealer_code, eacc_type.main_account, :new.dealer_name, eacc_status.available, :new.dealer_code||'01', 0, 0, 0, '--');

  -- 增加游戏授权
  for tab in (select * from inf_games) loop
    insert into cncp_auth_dealer
      (dealer_code, game_code, sale_commission_rate, is_sale, modify_admin, modify_date)
    values
      (:new.dealer_code, tab.game_code, 0, 0, 0, sysdate);
  end loop;
  
  -- 增加渠道安全信息
  insert into cncp_security_dealer
    (dealer_code, public_key)
  values
    (:new.dealer_code, ' ');

end;
