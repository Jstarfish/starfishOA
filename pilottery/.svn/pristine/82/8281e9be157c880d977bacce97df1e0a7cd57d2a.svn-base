<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cls.pilottery.oms.monitor.dao.MGameIssueDao">

	<resultMap type="cls.pilottery.oms.monitor.model.GameIssue" id="gameIssueResult">
		<id column="GAME_CODE" property="gameCode" />
		<id column="ISSUE_NUMBER" property="issueNumber" />
		
		<result column="ISSUE_SEQ" property="issueSeq" />
		<result column="ISSUE_STATUS" property="issueStatus" />
		<result column="IS_PUBLISH" property="isPublish" />
		<result column="DRAW_STATE" property="drawState" />
		<result column="REAL_START_TIME" property="realStartTime" />
		<result column="REAL_REWARD_TIME" property="realRewardTime" />
		<result column="REAL_CLOSE_TIME" property="realCloseTime" />
		<result column="ISSUE_END_TIME" property="issueEndTime" />
		<result column="FIRST_DRAW_USER_ID" property="firstDrawUser" />
		<result column="SECOND_DRAW_USER_ID" property="secondDrawUser" />
		<result column="FINAL_DRAW_NUMBER" property="finalDrawNumber" />
		<result column="FINAL_DRAW_USER_ID" property="finalDrawUserId" />
		
		<result column="POOL_START_AMOUNT" property="poolStartAmount" />
		<result column="POOL_CLOSE_AMOUNT" property="poolCloseAmount" />
		<result column="WINNING_AMOUNT" property="winningAmount" />
		<result column="ISSUE_SALE_AMOUNT" property="issueSaleAmount" />
		<result column="ISSUE_SALE_TICKETS" property="issueSaleTickets" />
		<result column="ISSUE_CANCEL_AMOUNT" property="issueCancelAmount" />
		<result column="ISSUE_CANCEL_TICKETS" property="issueCancelTickets" />
		<result column="ISSUE_RICK_TICKETS" property="issueRickTickets" />
		<result column="ISSUE_RICK_AMOUNT" property="issueRickAmount" />
		<result column="WINNING_RESULT" property="winningResult" />
	</resultMap>
	
	<resultMap type="cls.pilottery.oms.monitor.model.GameIssueDetail" id="gameIssueDetail">
		<id column="ISSUE_NUMBER" property="issueNumber" />
		<id column="GAME_CODE" property="gameCode" />
		<result column="XML_CONTENT" property="xmlContent"/>
	</resultMap>
	 
	
	<select id="listCount" parameterType="cls.pilottery.oms.monitor.model.GameIssue" resultType="int">
  		select count(n.GAME_CODE) from ISS_GAME_ISSUE n where ISSUE_STATUS !=0 AND   n.GAME_CODE = ${gameCode}
    </select>
	
    
    <select id="listGameIssue" resultMap="gameIssueResult"
		parameterType="cls.pilottery.oms.monitor.model.GameIssue">
		select *
		from (select tab.*, rownum rn
		from (select * from ISS_GAME_ISSUE m
		WHERE ISSUE_STATUS !=0 AND m.GAME_CODE = ${gameCode}
		<![CDATA[ ) TAB ) where rn > ${beginNum} and rn <= ${endNum} ]]>
	</select>
    
    <select id="findGameIssueByCode" parameterType="map" resultMap="gameIssueResult"> 
		select * from ISS_GAME_ISSUE where ISSUE_NUMBER = #{issueNumber} and GAME_CODE = ${gameCode}
    </select>
	
	
	<select id="queryGameIssueDetail" parameterType="cls.pilottery.oms.monitor.model.GameIssueDetail" resultMap="gameIssueDetail">
		SELECT * FROM  ISS_GAME_ISSUE_MODULE where 1=1
		<if test="issueNumber!=0">
			AND ISSUE_NUMBER = #{issueNumber}
		</if>
		<if test="gameCode!=0">
			AND GAME_CODE = #{gameCode}
		</if>
	</select>

</mapper>

