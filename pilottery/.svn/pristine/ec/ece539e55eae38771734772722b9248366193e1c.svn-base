<%@ page language="java" contentType="text/html; charset=utf-8" pageEncoding="utf-8" %>
<%@ include file="/views/common/taglibs.jsp" %>
<html>
<head>
    <title>Fbs Match Draw</title>
    <%@ include file="/views/common/meta.jsp" %>
    <link rel="stylesheet" type="text/css" href="${basePath}/css/city-list.css"/>
    <link rel="stylesheet" type="text/css" href="${basePath}/css/style.css"/>
    <link type="text/css" rel="stylesheet" href="${basePath}/views/oms/game-draw/css/myStyle.css"/>

    <link rel="stylesheet" href="${basePath}/component/messageBox/myJsBox.css" type="text/css"/>
    <script type="text/javascript" src="${basePath}/component/messageBox/myJsBox_zh.js"></script>
    <script type="text/javascript" src="${basePath}/js/jquery/jquery.form.js"></script>
    <script type="text/javascript" src="${basePath}/js/jquery/jquery-1.9.1.js"></script>
    <script type="text/javascript" src="${basePath}/component/My97DatePicker/WdatePicker.js"></script>
    <script type="text/javascript" src="${basePath}/js/oms/myJs.js"></script>
    <script type="text/javascript" src="${basePath}/js/oms/city-list.js"></script>

    <script type="text/javascript" charset="UTF-8">
        jQuery(document).ready(function ($) {
            $("input[type='text']").each(
                    function () {
                        $(this).keypress(function (e) {
                            var key = window.event ? e.keyCode : e.which;
                            if (key.toString() == "13") {
                                return false;
                            }
                        });
                    }
            );
            $("#secondfhHomeScore").click(function () {
                document.getElementById("secondfhHomeScoreTip").innerHTML = "*";
                $("#secondfhHomeScoreTip").css("color", "#CDC9C9");
            });
            $("#secondfhGuestScore").click(function () {
                document.getElementById("secondfhGuestScoreTip").innerHTML = "*";
                $("#secondfhGuestScoreTip").css("color", "#CDC9C9");
            });
            $("#secondshHomeScore").click(function () {
                document.getElementById("secondshHomeScoreTip").innerHTML = "*";
                $("#secondshHomeScoreTip").css("color", "#CDC9C9");
            });
            $("#secondshGuestScore").click(function () {
                document.getElementById("secondshGuestScoreTip").innerHTML = "*";
                $("#secondshGuestScoreTip").css("color", "#CDC9C9");
            });
            $("#calculate").click(function () {
                document.getElementById("resultTip").innerHTML = "";
                $("#resultTip").css("color", "#CDC9C9");
            });
        });

        function checkData() {
            var secondfhHomeScore = $("#secondfhHomeScore").val();
            var secondfhGuestScore = $("#secondfhGuestScore").val();
            var secondshHomeScore = $("#secondshHomeScore").val();
            var secondshGuestScore = $("#secondshGuestScore").val();
            if (secondfhHomeScore == "" || secondfhHomeScore < 0) {
                document.getElementById("secondfhHomeScoreTip").innerHTML = 'Invalid Data';
                $("#secondfhHomeScoreTip").css("color", "red");
                return false;
            }
            if (secondfhGuestScore == "" || secondfhGuestScore < 0) {
                document.getElementById("secondfhGuestScoreTip").innerHTML = 'Invalid Data';
                $("#secondfhGuestScoreTip").css("color", "red");
                return false;
            }
            if (secondshHomeScore == "" || secondshHomeScore < 0) {
                document.getElementById("secondshHomeScoreTip").innerHTML = 'Invalid Data';
                $("#secondshHomeScoreTip").css("color", "red");
                return false;
            }
            if (secondshGuestScore == "" || secondshGuestScore < 0) {
                document.getElementById("secondshGuestScoreTip").innerHTML = 'Invalid Data';
                $("#secondshGuestScoreTip").css("color", "red");
                return false;
            }
            return true;
        }

        function calculateSubmit() {
            if (checkData()) {
                var url = "fbsDraw.do?method=calculate2FbsResult";
                $.ajax({
                    cache: true,
                    async: false,
                    url: url,
                    type: "get",
                    dataType: "json",
                    data: $('#calculateForm').serialize(),
                    success: function (r) {
                        if (r.msg != '' && r.msg != null) {
                            closeDialog();
                            showError(decodeURI(r.msg));
                        } else {
                            document.getElementById("fullscore").innerHTML = r.fullScore;
                            document.getElementById("score30").innerHTML = r.full30Result;
                            document.getElementById("score310").innerHTML = r.full310Result;
                            document.getElementById("hfscore310").innerHTML = r.hf310Result;
                            if (r.hfSingleDouble == 1) {
                                document.getElementById("hfsingledouble").innerHTML = "Over Single";
                            } else if (r.hfSingleDouble == 2) {
                                document.getElementById("hfsingledouble").innerHTML = "Over Double";
                            } else if (r.hfSingleDouble == 3) {
                                document.getElementById("hfsingledouble").innerHTML = "Under Single";
                            } else {
                                document.getElementById("hfsingledouble").innerHTML = "Under Double";
                            }
                            document.getElementById("singlescore").innerHTML = r.singleScore;
                        }
                    }
                });
                return false;
            }
        }


        function changeSel(value) {
            if (value == 1) {
                $("#secondScoreTeam").attr("disabled", true);
                $("#secondScoreTeam").css("color", "gray");
                $("#calculate").attr("disabled", true);
                $("#calculate").css("background-color", "gray");
                $("#secondfhHomeScore").attr("readonly", true).css("color", "gray");
                $("#secondfhGuestScore").attr("readonly", true).css("color", "gray");
                $("#secondshHomeScore").attr("readonly", true).css("color", "gray");
                $("#secondshGuestScore").attr("readonly", true).css("color", "gray");
                document.getElementById("resultTip").innerHTML = "";
                $("#resultTip").css("color", "#CDC9C9");
            } else {
                $("#secondScoreTeam").attr("disabled", false);
                $("#secondScoreTeam").css("color", "black");
                $("#calculate").attr("disabled", false);
                $("#calculate").css("background-color", "#9bdb03");
                $("#secondfhHomeScore").attr("readonly", false).css("color", "black");
                $("#secondfhGuestScore").attr("readonly", false).css("color", "black");
                $("#secondshHomeScore").attr("readonly", false).css("color", "black");
                $("#secondshGuestScore").attr("readonly", false).css("color", "black");
                document.getElementById("resultTip").innerHTML = "";
                $("#resultTip").css("color", "#CDC9C9");
            }
        }

        function checkResult() {
            var team = $("#mactchResultStatus").val();
            if (team == 1) {
                return true;
            } else {
                var scor = $("#score310").text();
                if (scor == "") {
                    document.getElementById("resultTip").innerHTML = 'Please Calculate The Result';
                    $("#resultTip").css("color", "red");
                    return false;
                } else {
                    return true;
                }
            }
        }

        function doSubmit() {
            if (checkData()) {
                if (checkResult()) {
                    var url = "fbsDraw.do?method=submitSecondFbsDraw";
                    $("#calculateForm").attr("action", url);
                    button_off("okBtn");
                    $("#calculateForm").submit();
                }
            }
        }

    </script>

</head>
<body>
<div id="title">Second Draw</div>
<div id="mainDiv">
    <div class="jdt"
         style="background: url(views/oms/fbs/fbsdraw/img/fbsbj-2.png) no-repeat left top;width:850px;"></div>
    <div class="xd" style="width:850px">
        <span style="margin-left: 30px;">1.Type In Result</span>
        <span class="zi" style="margin-left: 25px;">2.Wait For Type In Result Again</span>
        <span style="margin-left: 25px;">3.Show Result</span>
        <span style="margin-left: 25px;">4.Drawing</span>
        <span style="margin-left: 25px;">5.Show Draw Result</span>
        <span style="margin-left: 25px;">6.Draw Finish</span>
    </div>
    <div class="CPage">
        <table width="80%" border="0" cellpadding="0" cellspacing="0">
            <tbody>
            <tr>
                <td align="left" valign="middle">
                    <div class="tab" style="height:500px;">
                        <table border="0" cellpadding="0" cellspacing="0" height="100%" width="100%" class="tabxian">
                            <tbody>
                            <tr>
                                <td class="tit"><span style="font-size: 24px;">2.Wait For Type In Result Again </span></td>
                            </tr>
                            <tr>
                                <td>
                                    <table width="90%" align="center" cellpadding="0" cellspacing="0">
                                        <tbody>
                                        <tr>
                                            <td width="11%" height="30px" class="lzx">
                                                <div align="right">Match Code:</div>
                                            </td>
                                            <td width="14%" height="30px" class="lzx" style="text-align: left">
                                                ${fbsMatch.matchCode}
                                            </td>
                                            <td class="lzx" height="30px">
                                                <div align="right">Home Team:</div>
                                            </td>
                                            <td class="lzx" height="30px" style="text-align: left">
                                                ${fbsMatch.homeTeam}
                                            </td>

                                            <td width="14%" height="30px" class="lzx">
                                                <div align="right">Competition:</div>
                                            </td>
                                            <td width="11%" height="30px" class="lzx" style="text-align: left">
                                                ${fbsMatch.matchComp}
                                            </td>
                                            <td class="lzx" height="30px">
                                                <div align="right">310 Concede Points:</div>
                                            </td>
                                            <td class="lzx" height="30px" style="text-align: left">${fbsMatch.score310}</td>
                                        </tr>
                                        <tr>
                                            <td width="14%" height="30px" class="lzx">
                                                <div align="right">Issue:</div>
                                            </td>
                                            <td width="13%" height="30px" class="lzx" style="text-align: left">
                                                ${fbsMatch.matchIssue}
                                            </td>
                                            <td class="lzx" height="30px">
                                                <div align="right">Guest Team:</div>
                                            </td>
                                            <td class="lzx" height="30px" style="text-align: left">${fbsMatch.guestTeam}</td>
                                            <td width="14%" height="30px" class="lzx">
                                                <div align="right">Match Status:</div>
                                            </td>
                                            <td width="9%" height="30px" class="lzx" style="text-align: left">
                                                <c:if test="${fbsMatch.matchStatus==3}">Sale Over</c:if>
                                                <c:if test="${fbsMatch.matchStatus==4}">Type In Result</c:if>
                                                <c:if test="${fbsMatch.matchStatus==5}">Reward Finish</c:if>
                                            </td>
                                            <td class="lzx" height="30px">
                                                <div align="right">30 Concede Points:</div>
                                            </td>
                                            <td class="lzx" height="30px" style="text-align: left">${fbsMatch.score30}</td>
                                        </tr>
                                        <tr>
                                            <td colspan="8" style="border-bottom:1px solid #eff1f4;">&nbsp;</td>
                                        </tr>
                                        </tbody>
                                    </table>
                            <tr>
                                <td>
                                    <form id="calculateForm" method="post">
                                        <table width="85%" border="0" align="center" cellpadding="0" cellspacing="0"
                                               style=" font-size:14px;">
                                            <input type="hidden" name="matchCode" value="${fbsMatch.matchCode}">
                                            <tbody>
                                            <tr>
                                                <td height="30px" class="xh">Result Status:</td>
                                                <td height="30px" align="left">
                                                    <select class="select-normal" id="mactchResultStatus"
                                                                                       name="matchResultStatus" onchange="changeSel(this.value)">
                                                    <option value="0" selected>Regular</option>
                                                    <option value="1">Canceled</option>
                                                </select></td>
                                                <td height="30px" class="xh">First Goal Team:</td>
                                                <td height="30px" align="left">
                                                    <select class="select-normal" id="secondScoreTeam" name="secondScoreTeam">
                                                        <option value="0">No Team</option>
                                                        <option value="${fbsMatch.homeTeamCode}">Home Team</option>
                                                        <option value="${fbsMatch.guestTeamCode}">Guest Team</option>
                                                    </select>
                                                </td>
                                                <td height="30px" colspan="2" width="10px"></td>
                                            </tr>

                                            <tr>
                                                <td height="30px" class="xh">First Half Home Team Score:</td>
                                                <td height="30px" align="left">
                                                    <input type="text" class="text-normal" value="0"
                                                           id="secondfhHomeScore" name="secondfhHomeScore">
                                                    <span id="secondfhHomeScoreTip" style="color:#CDC9C9">*</span>
                                                </td>
                                                <td height="30px">
                                                    <div class="xh">First Half Guest Team Score:</div>
                                                </td>
                                                <td height="30px" align="left">
                                                    <input type="text" class="text-normal" value="0"
                                                           id="secondfhGuestScore" name="secondfhGuestScore">
                                                    <span id="secondfhGuestScoreTip" style="color:#CDC9C9">*</span>
                                                </td>
                                                <td height="30px" colspan="2" width="10px"></td>
                                            </tr>
                                            <tr>
                                                <td height="30px" class="xh">Second Half Home Team Score:</td>
                                                <td height="30px" align="left">
                                                    <input type="text" class="text-normal" value="0"
                                                           id="secondshHomeScore" name="secondshHomeScore">
                                                    <span id=secondshHomeScoreTip" style="color:#CDC9C9">*</span>
                                                </td>
                                                <td height="30px" class="xh">Second Half Guest Team Score:</td>
                                                <td height="30px" align="left">
                                                    <input type="text" class="text-normal" value="0"
                                                           id="secondshGuestScore" name="secondshGuestScore">
                                                    <span id=secondshGuestScoreTip" style="color:#CDC9C9">*</span>
                                                </td>
                                                <td height="30px" colspan="2" width="10px"><input type="button"
                                                                                                  id="calculate"
                                                                                                  class="button-normal"
                                                                                                  onClick="calculateSubmit()"
                                                                                                  value="Calculate"></td>
                                            </tr>
                                            </tbody>
                                        </table>
                                    </form>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <table border="0" width="85%" align="center" cellpadding="0" cellspacing="0"
                                           style="border:1px solid #eff1f4;  font-size:14px;">
                                        <tbody>
                                        <tr>
                                            <td height="10px" colspan="4"><span id="resultTip"
                                                                                style="color:#CDC9C9"></span></td>
                                        </tr>
                                        <tr>
                                            <td width="22%" height="30px" class="xh">310 Result(Concede):</td>
                                            <td width="22%" height="30px" align="left"><span id="score310"></span></td>
                                            <td width="24%" height="30px" class="xh">30 Result(Concede):</td>
                                            <td width="32%" height="30px" align="left"><span id="score30"></span></td>
                                        </tr>
                                        <tr>
                                            <td height="30px" class="xh">Half Full 310 Result:</td>
                                            <td height="30px" align="left"><span id="hfscore310"></span></td>
                                            <td height="30px" class="xh">Over Under Single Double:</td>
                                            <td height="30px" align="left"><span id="hfsingledouble"></span></td>
                                        </tr>
                                        <tr>
                                            <td height="30px" class="xh">Full Score:</td>
                                            <td height="30px" align="left"><span id="fullscore"></span></td>
                                            <td height="30px" class="xh">Single Score:</td>
                                            <td height="30px" align="left"><span id="singlescore"></span></td>
                                        </tr>
                                        </tbody>
                                    </table>
                                        <div align="center">
                                       <input id="okBtn" type="button" value="Submit" onClick="doSubmit();" class="button-normal">
                                     </div></td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                </td>
            </tr>
            <tr height="80">
                <td align="center" valign="middle"></td>
                <td></td>
            </tr>
            </tbody>
        </table>
    </div>
</div>
</body>
</html>