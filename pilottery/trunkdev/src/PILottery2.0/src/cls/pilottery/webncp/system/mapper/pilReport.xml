<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cls.pilottery.webncp.system.dao.pil.PILDataReportDao">

	<select id="getAgencyFlow3006" resultType="cls.pilottery.webncp.system.model.DealFlowModel" parameterType="cls.pilottery.webncp.system.model.Request3006Model">
		SELECT FLOW_TYPE type, 
			CHANGE_AMOUNT amount, 
			TRADE_TIME dealTime
		  FROM (SELECT ROWNUM rn, t.*
		          FROM (  SELECT AGENCY_FUND_FLOW,
		                         FLOW_TYPE,
		                         CHANGE_AMOUNT,
		                         TRADE_TIME
		                    FROM FLOW_AGENCY
		                   WHERE TO_CHAR (trade_time, 'yyyymmdd') = #{date}
		                     AND agency_code = #{agencyCode}
		                ORDER BY agency_fund_flow DESC) t)
		 <![CDATA[WHERE rn > (#{pageIndex} - 1) * #{pageSize} AND rn <= #{pageIndex} * #{pageSize}  ]]>
	</select>
	
	<select id="getAccountBalance" resultType="cls.pilottery.webncp.system.model.Response3010Model" parameterType="String">
		select  CREDIT_LIMIT credit,
				ACCOUNT_BALANCE balance,
				CREDIT_LIMIT+ACCOUNT_BALANCE available
		  from  ACC_AGENCY_ACCOUNT 
		 where  AGENCY_CODE = #{outletCode}
	</select>
	
	<select id="getOrgCodeByAgency" resultType="String" parameterType="String">
		select  ORG_CODE 
		  from  INF_AGENCYS 
		 where  AGENCY_CODE = #{agencyCode}
	</select>
</mapper>
