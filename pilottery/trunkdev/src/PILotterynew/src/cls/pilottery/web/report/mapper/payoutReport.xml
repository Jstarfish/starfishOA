<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cls.pilottery.web.report.dao.PayoutReportDao">
    <select id="getPayoutList" parameterType="cls.pilottery.web.report.form.SaleReportForm"
        resultType="cls.pilottery.web.report.model.PayoutReportModel"
    >

        SELECT A.SALE_DAY PAYOUTDATE,
        PLAN_CODE GAMENAME,
        A.LEVEL_1 onePRIZE,
        A.LEVEL_2 twoPRIZE,
        A.LEVEL_3 threePRIZE,
        A.LEVEL_4
        fourPRIZE,
        A.LEVEL_5 fivePRIZE,
        A.LEVEL_6 sixPRIZE,
        A.LEVEL_7 senvenPRIZE,
        A.LEVEL_8 eightPRIZE,
        a.total amount
        FROM V_REPORT_PAY_LEVEL A
        WHERE 1 = 1 
        <if test="beginDate != null and beginDate != ''">
            AND SALE_DAY between #{beginDate} and #{endDate}
        </if>
        <if test="planCode != null and planCode != ''">
            AND a.plan_code =#{planCode}
        </if>
        <if test="cuserOrg != '00'">
            and ORG_CODE = #{cuserOrg}
          </if>
         ORDER BY PAYOUTDATE desc
    </select>
    <select id="getPayout" parameterType="cls.pilottery.web.report.form.SaleReportForm"
        resultType="cls.pilottery.web.report.model.PayoutReportModel"
    >

        SELECT
        sum(A.LEVEL_1) onePRIZE,
        sum(A.LEVEL_2) twoPRIZE,
        sum(A.LEVEL_3) threePRIZE,
        sum(A.LEVEL_4) fourPRIZE,
        sum(A.LEVEL_5) fivePRIZE,
        sum(A.LEVEL_6) sixPRIZE,
        sum(A.LEVEL_7) senvenPRIZE,
        sum(A.LEVEL_8) eightPRIZE,
        sum(a.total) amount
        FROM V_REPORT_PAY_LEVEL A
        WHERE 1 = 1
        <if test="beginDate != null and beginDate != ''">
            AND SALE_DAY between #{beginDate} and #{endDate}
        </if>
        <if test="planCode != null and planCode != ''">
            AND a.plan_code =#{planCode}
        </if>
        <if test="cuserOrg != '00'">
            and ORG_CODE = #{cuserOrg}
          </if>
    </select>
</mapper>