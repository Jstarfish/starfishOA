<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cls.pilottery.webncp.system.dao.TdsProcessDao">

	<select id="getLastDrawIssue" parameterType="int" resultType="long">
		select max(issue_number) from iss_game_issue 
		where draw_state = 16 and issue_status = 13 and game_code = #{_parameter}
	</select>
	
	<update id="getDrawAnnouncement" statementType="CALLABLE" parameterType="cls.pilottery.webncp.system.model.Response30d4Model">
		{call p_om_tds_issue_draw_notice(
			#{gameCode,mode=IN,jdbcType=NUMERIC},
			#{issueNumber,mode=IN,jdbcType=NUMERIC},
			#{resultJson,mode=OUT,jdbcType=VARCHAR},
			#{errorCode,mode=OUT,jdbcType=NUMERIC},
			#{errorMesg,mode=OUT,jdbcType=VARCHAR}
			)
		}
	</update>
	
	<select id="getTdsVersion" resultType="string">
		select SYS_DEFAULT_VALUE from sys_parameter where SYS_DEFAULT_SEQ = 1104
	</select>

</mapper>
